<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>GAS 通信テスト</title>
    <style>
        body { font-family: sans-serif; display: grid; place-content: center; height: 100vh; text-align: center; }
        button { font-size: 1.5rem; padding: 1rem 2rem; cursor: pointer; }
        #result { margin-top: 2rem; font-size: 1.2rem; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Google Apps Script 通信テスト</h1>
    <button id="testButton">テスト実行</button>
    <div id="result">ここに結果が表示されます</div>

    <script>
        // ★★★ ステップ1でコピーした「新しいデプロイURL」をここに貼り付けてください ★★★
        const GAS_URL = 'https://script.google.com/macros/s/AKfycbxoNYcNKCdevtWmbm8na-Dig6Hoh3ukf-3HpfO3YTmfOEBLyIA2XB92SckiWKS-iFFHvg/exec';

        document.getElementById('testButton').addEventListener('click', async () => {
            const resultDiv = document.getElementById('result');
            resultDiv.textContent = '通信中...';
            resultDiv.style.color = 'black';

            try {
                const response = await fetch(GAS_URL, {
                    method: 'POST',
                    mode: 'cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'test' }) // 送るデータは何でもOK
                });

                if (!response.ok) {
                    throw new Error(`サーバーエラー: ${response.status}`);
                }

                const data = await response.json();

                if (data.status === 'success') {
                    resultDiv.textContent = `成功！サーバーからの返事: "${data.message}"`;
                    resultDiv.style.color = 'green';
                } else {
                    throw new Error(data.message);
                }

            } catch (error) {
                console.error('詳細なエラー:', error);
                resultDiv.textContent = `失敗... エラー内容: ${error.message} (詳細はコンソールを確認)`;
                resultDiv.style.color = 'red';
            }
        });
    </script>
</body>
</html>
